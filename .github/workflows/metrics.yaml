name: Metrics

on:
  schedule:
    - cron: 0 0 * * *

  workflow_dispatch:

jobs:
  metrics:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:
      - uses: lowlighter/metrics@65836723097537a54cd8eb90f61839426b4266b6 # v3.34
        with:
          base: metadata
          base_indepth: yes
          config_timezone: Asia/Tokyo
          plugin_languages: yes
          plugin_languages_details: lines,percentage
          plugin_languages_indepth: yes
          plugin_notable: yes
          plugin_notable_indepth: yes
          plugin_notable_filter: stars:>100
          plugin_notable_from: all
          plugin_notable_repositories: yes
          plugin_notable_types: commit,issue,pull_request
          token: ${{ secrets.METRICS_TOKEN }}
